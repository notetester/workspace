
/* Drop Triggers */

DROP TRIGGER TRI_BOARDLIST_BOARDNUMBER;
DROP TRIGGER TRI_REPLYLIST_REPLYNUMBER;



/* Drop Tables */

DROP TABLE BOARDGOODCLICKER CASCADE CONSTRAINTS;
DROP TABLE REPLYGOODCLICKER CASCADE CONSTRAINTS;
DROP TABLE REPLYLIST CASCADE CONSTRAINTS;
DROP TABLE BOARDLIST CASCADE CONSTRAINTS;
DROP TABLE FRIENDLIST CASCADE CONSTRAINTS;
DROP TABLE MEMBERSLIST CASCADE CONSTRAINTS;



/* Drop Sequences */

DROP SEQUENCE SEQ_BOARDLIST_BOARDNUMBER;
DROP SEQUENCE SEQ_REPLYLIST_REPLYNUMBER;




/* Create Sequences */

CREATE SEQUENCE SEQ_BOARDLIST_BOARDNUMBER INCREMENT BY 1 START WITH 1;
CREATE SEQUENCE SEQ_REPLYLIST_REPLYNUMBER INCREMENT BY 1 START WITH 1;



/* Create Tables */

CREATE TABLE BOARDGOODCLICKER
(
	BOARDNUMBER number(10,0) NOT NULL UNIQUE,
	MEMBERID varchar2(30) NOT NULL UNIQUE,
	BOARDGOODDATE date DEFAULT SYSDATE NOT NULL,
	PRIMARY KEY (BOARDNUMBER, MEMBERID),
	UNIQUE (BOARDNUMBER, MEMBERID)
);


CREATE TABLE BOARDLIST
(
	BOARDNUMBER number(10,0) NOT NULL UNIQUE,
	MEMBERID varchar2(30) NOT NULL,
	BOARDTITLE varchar2(100) NOT NULL,
	BOARDCONTENT varchar2(3000) NOT NULL,
	BOARDDATE date DEFAULT SYSDATE NOT NULL,
	BOARDUPDATE date DEFAULT SYSDATE NOT NULL,
	BOARDGOODCOUNT number(10,0) NOT NULL,
	PRIMARY KEY (BOARDNUMBER)
);


CREATE TABLE FRIENDLIST
(
	MEMBERID varchar2(30) NOT NULL UNIQUE,
	FRIENDID varchar2(30) NOT NULL UNIQUE,
	FRIENDREGISTRYDATE date DEFAULT SYSDATE NOT NULL,
	PRIMARY KEY (MEMBERID, FRIENDID),
	UNIQUE (MEMBERID, FRIENDID)
);


CREATE TABLE MEMBERSLIST
(
	MEMBERID varchar2(30) NOT NULL UNIQUE,
	MEMBERNAME varchar2(30) NOT NULL,
	MEMBERADDRESS varchar2(30) NOT NULL,
	MEMBERCALL varchar2(30) NOT NULL,
	MEMBERREGISTRY date DEFAULT SYSDATE NOT NULL,
	MEMBERUPDATE date DEFAULT SYSDATE NOT NULL,
	PRIMARY KEY (MEMBERID)
);


CREATE TABLE REPLYGOODCLICKER
(
	REPLYNUMBER number(10,0) NOT NULL UNIQUE,
	MEMBERID varchar2(30) NOT NULL UNIQUE,
	REPLYGOODDATE date DEFAULT SYSDATE NOT NULL,
	PRIMARY KEY (REPLYNUMBER, MEMBERID),
	UNIQUE (REPLYNUMBER, MEMBERID)
);


CREATE TABLE REPLYLIST
(
	REPLYNUMBER number(10,0) NOT NULL UNIQUE,
	BOARDNUMBER number(10,0) NOT NULL,
	MEMBERID varchar2(30) NOT NULL,
	REPLYTITLE varchar2(100) NOT NULL,
	REPLYCONTENT varchar2(1000) NOT NULL,
	REPLYDATE date DEFAULT SYSDATE NOT NULL,
	REPLYUPDATE date DEFAULT SYSDATE NOT NULL,
	REPLYGOODCOUNT number(10,0) NOT NULL,
	PRIMARY KEY (REPLYNUMBER)
);



/* Create Foreign Keys */

ALTER TABLE BOARDGOODCLICKER
	ADD FOREIGN KEY (BOARDNUMBER)
	REFERENCES BOARDLIST (BOARDNUMBER)
;


ALTER TABLE REPLYLIST
	ADD FOREIGN KEY (BOARDNUMBER)
	REFERENCES BOARDLIST (BOARDNUMBER)
;


ALTER TABLE BOARDGOODCLICKER
	ADD FOREIGN KEY (MEMBERID)
	REFERENCES MEMBERSLIST (MEMBERID)
;


ALTER TABLE BOARDLIST
	ADD FOREIGN KEY (MEMBERID)
	REFERENCES MEMBERSLIST (MEMBERID)
;


ALTER TABLE FRIENDLIST
	ADD FOREIGN KEY (MEMBERID)
	REFERENCES MEMBERSLIST (MEMBERID)
;


ALTER TABLE FRIENDLIST
	ADD FOREIGN KEY (FRIENDID)
	REFERENCES MEMBERSLIST (MEMBERID)
;


ALTER TABLE REPLYGOODCLICKER
	ADD FOREIGN KEY (MEMBERID)
	REFERENCES MEMBERSLIST (MEMBERID)
;


ALTER TABLE REPLYLIST
	ADD FOREIGN KEY (MEMBERID)
	REFERENCES MEMBERSLIST (MEMBERID)
;


ALTER TABLE REPLYGOODCLICKER
	ADD FOREIGN KEY (REPLYNUMBER)
	REFERENCES REPLYLIST (REPLYNUMBER)
;



/* Create Triggers */

CREATE OR REPLACE TRIGGER TRI_BOARDLIST_BOARDNUMBER BEFORE INSERT ON BOARDLIST
FOR EACH ROW
BEGIN
	SELECT SEQ_BOARDLIST_BOARDNUMBER.nextval
	INTO :new.BOARDNUMBER
	FROM dual;
END;

/

CREATE OR REPLACE TRIGGER TRI_REPLYLIST_REPLYNUMBER BEFORE INSERT ON REPLYLIST
FOR EACH ROW
BEGIN
	SELECT SEQ_REPLYLIST_REPLYNUMBER.nextval
	INTO :new.REPLYNUMBER
	FROM dual;
END;

/




